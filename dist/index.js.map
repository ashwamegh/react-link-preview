{"version":3,"file":"index.js","sources":["../src/components/LinkPreview.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport styles from './LinkPreview.css'\n\nconst isValidUrlProp = (props, propName, componentName) => {\n  if (!props) {\n    return new Error(`Required parameter URL was not passed.`)\n  }\n  if (!isValidUrl(props[propName])) {\n    return new Error(\n      `Invalid prop '${propName}' passed to '${componentName}'. Expected a valid url.`\n    )\n  }\n}\n\nconst isValidUrl = (url) => {\n  const regex =\n    /https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/\n  const validUrl = regex.test(url)\n  return validUrl\n}\n\nfunction LinkPreview(props) {\n  const [loading, setLoading] = useState(true)\n  const [preview, setPreviewData] = useState({})\n  const [isUrlValid, setUrlValidation] = useState(false)\n\n  const {\n    url,\n    width,\n    maxWidth,\n    marginTop,\n    marginBottom,\n    marginRight,\n    marginLeft,\n    onClick,\n    render,\n    customDomain\n  } = props\n\n  const style = {\n    width,\n    maxWidth,\n    marginTop,\n    marginBottom,\n    marginRight,\n    marginLeft\n  }\n\n  useEffect(() => {\n    async function fetchData() {\n      const fetch = window.fetch\n      if (isValidUrl(url)) {\n        setUrlValidation(true)\n      } else {\n        return {}\n      }\n      setLoading(true)\n      const response = await fetch(customDomain, {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ url })\n      })\n      const data = await response.json()\n      setPreviewData(data)\n      setLoading(false)\n    }\n    fetchData()\n  }, [url])\n\n  if (!isUrlValid) {\n    console.error(\n      'LinkPreview Error: You need to provide url in props to render the component'\n    )\n    return null\n  }\n\n  // If the user wants to use its own element structure with the fetched data\n  if (render) {\n    return render({\n      loading: loading,\n      preview: preview\n    })\n  } else if (loading) {\n    return (\n      <div>\n        <div className={styles['link-preview-section']} style={style}>\n          <div className={styles['link-description']}>\n            <div className={styles.domain}>\n              <span\n                className={\n                  (styles['link-url-loader'], styles['animated-background'])\n                }\n              >\n                facebook.com\n              </span>\n            </div>\n            <div className={styles['link-data-loader']}>\n              <div className={(styles.p1, styles['animated-background'])}>\n                Shashank Shekhar\n              </div>\n              <div className={(styles.p2, styles['animated-background'])}>\n                This is some description\n              </div>\n            </div>\n          </div>\n          <div className={styles['link-image-loader']}>\n            <div className={styles.img} />\n          </div>\n        </div>\n      </div>\n    )\n  } else {\n    return (\n      <div>\n        <div\n          className={styles['link-preview-section']}\n          style={style}\n          onClick={onClick}\n        >\n          <div className={styles['link-description']}>\n            <div className={styles.domain}>\n              <span className={styles['link-url']}>{preview.domain}</span>\n            </div>\n            <div className={styles['link-data']}>\n              <div className={styles['link-title']}>{preview.title}</div>\n              <div className={styles['link-description']}>\n                {preview.description}\n              </div>\n            </div>\n          </div>\n          <div className={styles['link-image']}>\n            {preview.img && <img src={preview.img} alt={preview.description} />}\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nLinkPreview.defaultProps = {\n  onClick: () => {},\n  width: '90%',\n  maxWidth: '700px',\n  marginTop: '18px',\n  marginBottom: '18px',\n  marginRight: 'auto',\n  marginLeft: 'auto',\n  customDomain: 'https://lpdg-server.azurewebsites.net/parse/link'\n}\n\nLinkPreview.propType = {\n  url: isValidUrlProp,\n  onClick: PropTypes.func,\n  render: PropTypes.func,\n  width: PropTypes.string,\n  maxWidth: PropTypes.string,\n  marginTop: PropTypes.string,\n  marginBottom: PropTypes.string,\n  marginRight: PropTypes.string,\n  marginLeft: PropTypes.string,\n  customDomain: PropTypes.string\n}\n\nexport default LinkPreview\n"],"names":["isValidUrlProp","props","propName","componentName","Error","isValidUrl","url","regex","validUrl","test","LinkPreview","_useState","useState","loading","setLoading","_useState2","preview","setPreviewData","_useState3","isUrlValid","setUrlValidation","width","maxWidth","marginTop","marginBottom","marginRight","marginLeft","onClick","render","customDomain","style","useEffect","fetchData","fetch","window","Promise","resolve","method","headers","Accept","body","JSON","stringify","then","response","json","data","e","reject","console","error","React","createElement","className","styles","domain","img","title","description","src","alt","defaultProps","propType","PropTypes","func","string"],"mappings":"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"}